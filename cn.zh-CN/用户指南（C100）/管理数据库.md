# 管理数据库 {#concept_610202 .concept}

本文介绍了在数据库审计系统中添加、编辑、删除数据库的具体操作。在进行数据库审计前，您必须在数据库审计系统中添加要审计的数据库。已添加的数据库支持编辑和删除操作。

## 添加数据库 {#section_tcd_56s_5ir .section}

**背景信息**

您可以在数据库审计系统中添加RDS数据库或通用型数据库。

-   支持添加的RDS数据库类型和版本如下：

    -   MySQL：5.7/5.6/5.5
    -   SQL Server：2017/2016/2012/2008
    -   PostgreSQL：所有版本
    -   MariaDB：10.3
    添加RDS数据库时，您直接从阿里云账号下的RDS实例中选择要添加的对象。

-   支持添加的通用数据库类型和版本如下：

    -   Oracle：12c/11g/10g/9i/8i
    -   MySQL：5.7/5.6/5.5/5.1/5.0/4.1/4.0
    -   SQL Server：2017/2016/2014/2012/2008/2005/2000
    -   Sybase：12.5/11.9
    -   DB2：v95/v82/v81/v80
    -   Informix：所有版本
    -   达梦（DM）：所有版本
    -   PostgreSQL：所有版本
    -   人大金仓（Kingbase）：所有版本
    -   MariaDB：10.3/10.2/10.1/10.0/5.5/5.3/5.2/5.1
    -   Hana：1.0
    -   MongoDB：3.x/2.x
    添加通用型数据库时，您需要手动填入数据库的相关信息。


添加数据库时，默认启用最简配置模式，最简配置模式下的配置项均为必填项；您可以切换为更多配置模式，启用更多配置选项。例如，在更多配置模式下，您可以进行单双向审计配置。添加数据库后，系统默认采用双向审计，且审计结果不保存；您可以在单双向审计配置中选用单向或双向审计，并设置（双向审计时）审计结果的保存数量。

**操作步骤**

1.  登录云盾数据库审计系统。具体操作请参见[登录系统](cn.zh-CN/用户指南（C100）/登录系统.md#)。
2.  前往**系统管理** \> **数据库管理**页面，单击右上角的**添加数据库**。

    **说明：** 您也可以在总览页面，单击**资产卡片**下的**添加数据库**。

    ![](http://static-aliyun-doc.oss-cn-hangzhou.aliyuncs.com/assets/img/489607/156221892349316_zh-CN.png)

3.  在**添加数据库**侧边页，完成数据库配置，并单击**保存**。

    **说明：** 

    -   如果需要一次性添加多个数据库，您可以勾选**保存后不关闭，继续添加数据库**。这样设置后，在完成数据库配置并单击**保存**后，可以继续添加下一个数据库。
    -   添加数据库侧边页默认显示最简配置模式，您可以单击**更多配置**，显示全部配置；在更多配置模式下，单击**最简配置**，可以切换回最简配置模式。如无特殊需求，建议您使用最简配置模式添加数据库。
    -   添加RDS数据库

        |配置项|是否属于最简配置模式|说明|
        |---|----------|--|
        |类型|是|选择**RDS**，并选择要审计的RDS数据库的类型和版本。|
        |实例名|是|选择要审计的RDS数据库的实例ID。|
        |名称|是|设置数据库名称。选择RDS实例后，默认取RDS实例名作为名称，支持修改。|
        |IP端口|是|选择RDS实例名后自动填写，且不可修改。 **说明：** 成功添加数据库后，您可以通过[编辑数据库](#section_lbq_s1i_i0x)修改数据库的IP和端口。

 |
        |状态|否|勾选**启用**或**禁用**当前数据库审计配置。|
        |编码|否|审计数据的编码类型。支持UTF-8、UTF-16等多种类型。默认为**自动识别**。 **说明：** 如果您不清楚数据库的编码，可以先不作修改，保留默认值。当审计的内容不正确或包含乱码时，再使用其它编码类型。

 |
        |流量方向|否|勾选**双向审计**或**单向审计**。         -   双向审计的审计内容为：请求+客户端信息+服务端信息+返回信息。
        -   单向审计的审计内容为：请求+客户端信息+服务端信息。不包括返回信息。
 |
        |保存行数|否|流量方向为双向审计时，设置要保存的返回信息的行数。取值范围：0~999，0表示不保存返回结果。最多支持存储64K。|

        ![](http://static-aliyun-doc.oss-cn-hangzhou.aliyuncs.com/assets/img/489607/156221892449317_zh-CN.png)

    -   添加通用型数据库

        |配置项|是否属于最简配置模式|说明|
        |---|----------|--|
        |类型|是|选择**通用数据库**，并选择要审计的通用数据库的类型和版本。|
        |名称|是|设置数据库名称。|
        |操作系统|是|选择数据库服务器的操作系统类型，具体取值与数据库类型有关。|
        |IP端口|是|填写数据库的IP地址和端口。单击**增加IP与端口**可以增加多条记录。 **说明：** 在Oracle RAC或MySQL读写分离等场景中，您可以添加多个IP和端口，实现对整个集群的审计。

 |
        |状态|否|勾选**启用**或**禁用**当前数据库审计配置。|
        |编码|否|审计数据的编码类型。支持UTF-8、UTF-16等多种类型。默认为**自动识别**。 **说明：** 如果您不清楚数据库的编码，可以先不作修改，保留默认值。当审计的内容不正确或包含乱码时，再使用其它编码类型。

 |
        |流量方向|否|勾选**双向审计**或**单向审计**。         -   双向审计的审计内容为：请求+客户端信息+服务端信息+返回信息。
        -   单向审计的审计内容为：请求+客户端信息+服务端信息。不包括返回信息。
 |
        |保存行数|否|流量方向为双向审计时，设置要保存的返回结果的行数。取值范围：0~999，0表示不保存返回结果。最多支持存储64K。|

        ![](http://static-aliyun-doc.oss-cn-hangzhou.aliyuncs.com/assets/img/489607/156221892449318_zh-CN.png)


成功添加数据库。已添加的数据库显示在数据库管理页面。您也可以在总览页面的**资产卡片**下看到已添加的数据库。

![](http://static-aliyun-doc.oss-cn-hangzhou.aliyuncs.com/assets/img/489607/156221892449319_zh-CN.png)

添加数据库后，您还需要在数据库服务器上部署数据库审计的Agent程序，才能开启采集审计数据。具体操作请参见[部署Agent程序](cn.zh-CN/用户指南（C100）/部署Agent程序.md#)。

## 编辑数据库 {#section_lbq_s1i_i0x .section}

已添加到数据库审计系统中数据库配置发生变化时，您需要在数据库审计系统中更新数据库信息。

**操作步骤**

1.  登录云盾数据库审计系统。具体操作请参见[登录系统](cn.zh-CN/用户指南（C100）/登录系统.md#)。
2.  前往**系统管理** \> **数据库管理**页面，定位到要编辑的数据库，单击**编辑**。
3.  在编辑数据库侧边页，修改数据库配置，完成后单击**保存**。关于数据库的配置描述，请参见[添加数据库](#section_tcd_56s_5ir)步骤3。

成功修改数据库。

## 删除数据库 {#section_uhk_a5x_u3y .section}

如果不再需要审计某个数据库，您可以在数据库审计系统中删除数据库。

**操作步骤**

1.  登录云盾数据库审计系统。具体操作请参见[登录系统](cn.zh-CN/用户指南（C100）/登录系统.md#)。
2.  前往**系统管理** \> **数据库管理**页面，定位到要删除的数据库，单击**删除**。
3.  在删除提示中，单击**确定**。

成功删除数据库。

## 下一步 {#section_qfn_und_c5i .section}

-   添加数据库后，您必须在数据库服务器上部署数据库审计的Agent程序，才能使数据库审计服务收集目标数据库的访问流量信息。具体操作请参见[部署Agent程序](cn.zh-CN/用户指南（C100）/部署Agent程序.md#)。
-   添加数据库后，您可以为其配置审计规则，使命中规则的审计记录触发告警。具体操作请参见[为数据库配置审计规则](cn.zh-CN/用户指南（C100）/规则配置/为数据库配置审计规则.md#)。

