# 审计日志

通过审计日志，您可以查询所有审计数据。本文介绍了在云盾数据库审计系统中查询审计日志的具体操作。

1.  登录云盾数据库审计系统。具体操作请参见[登录数据库审计系统](/cn.zh-CN/用户指南（C100）/登录数据库审计系统.md)。

2.  在左侧导航栏，单击**查询分析** \> **审计日志**。

3.  在审计日志页面，设置要查询的**时间范围**和查询条件。

    ![查看审计日志](https://static-aliyun-doc.oss-cn-hangzhou.aliyuncs.com/assets/img/zh-CN/3464885851/p49354.png)

    审计查询功能可以帮助您准确定位到具体操作或语句，您可以参考以下步骤来设置查询条件。

    1.  设置**时间范围**。可选择：**最近5分钟**、**最近30分钟**、**最近1小时**、**最近6小时**、**本日**、**昨天**、**本周**、**本月**和自定义。
    2.  设置**报文内容**。

        ![](https://static-aliyun-doc.oss-cn-hangzhou.aliyuncs.com/assets/img/zh-CN/3464885851/p96658.png)

        -   如果您要查询的关键字为报文中的参数，那么您可以在**参数关键字**中输入关键字。
        -   如果您要查询的关键字是表名、字段名或者SQL语法中的关键词，可以单击模板后的输入框进行筛选，可筛选项包括**关键词**、**SQL模板ID**、**操作类型**。

            ![](https://static-aliyun-doc.oss-cn-hangzhou.aliyuncs.com/assets/img/zh-CN/4464885851/p96657.png)

    3.  设置**会话连接**。可根据会话连接信息进行查询，可筛选项包括：**客户端IP**、**客户端端口**、**数据库账号**、**服务端IP**、**服务端端口**、**会话ID**、**客户端工具**、**主机名**、**数据库类型**、**标识状态**。

        ![设置会话连接](https://static-aliyun-doc.oss-cn-hangzhou.aliyuncs.com/assets/img/zh-CN/4464885851/p96660.png)

    4.  单击**更多条件**可以显示更多筛选条件。可增加的筛选项包括**审计ID**、**数据库名/实例名**、**影响行数**、**执行时长**、**关联IP**、**关联账号**和**执行状态**。

        ![更多条件](https://static-aliyun-doc.oss-cn-hangzhou.aliyuncs.com/assets/img/zh-CN/4464885851/p49355.png)

        支持的筛选条件见下表。

        |筛选项|筛选子项|是否默认显示|说明|
        |---|----|------|--|
        |报文内容-参数关键字|参数关键字|是|关键字是报文中的参数，支持设置多个关键字，多个关键字之间以空格隔开。|
        |报文内容-模板|关键词|否|关键字为表名、字段名或者SQL语法中的关键词。|
        |SQL模板ID|否|要查询的SQL模板的ID。|
        |操作类型|否|SQL的操作类型。包含**Select**、**Insert**、**Update**等操作类型。 |
        |会话连接|客户端IP|否|需要连接数据库的客户端的IP地址，支持设置IPv4或IPv6地址。|
        |客户端端口|否|需要连接数据库的客户端的端口号。|
        |数据库账号|否|登录到数据库的账号名称。|
        |服务端IP|否|数据库服务器服务端的IP地址，支持设置IPv4或IPv6地址。|
        |服务端端口|否|数据库服务器服务端的端口号。|
        |会话ID|否|要查询的会话ID。|
        |客户端工具|否|登录数据库的客户端工具。|
        |主机名|否|数据库服务器的主机名。|
        |数据库名/实例名|否|数据库名称或实例名称。|
        |数据库类型|否|数据库的类型。|
        |标识状态|否|SQL的执行结果，取值如下：         -   未知
        -   登入成功
        -   登入失败 |
        |影响行数|影响行数|是|SQL的影响行数。|
        |执行时长|执行时长|是|SQL的执行时长。|
        |执行状态|执行状态|是|SQL的执行结果，取值如下：         -   全部（默认取值）
        -   未知
        -   执行成功
        -   执行失败 |
        |审计ID|审计ID|否|要查询的审计ID。输入多个值时请使用逗号（,）隔开。|
        |数据库名/实例名|数据库名/实例名|否|数据库名称或实例名称。|

    **说明：** 不同设置条件之间为**与**的关系。

4.  设置查询条件后，单击**保存**，可以保存查询条件。

    ![保存查询条件](https://static-aliyun-doc.oss-cn-hangzhou.aliyuncs.com/assets/img/zh-CN/4464885851/p49358.png)

    保存查询条件后，如果您后续需要使用相同查询条件，不需要重新设置，可以直接在查询条件下拉列表中选择。

    ![调用查询条件](https://static-aliyun-doc.oss-cn-hangzhou.aliyuncs.com/assets/img/zh-CN/4464885851/p49359.png)

5.  单击**搜索**，执行查询。

    **说明：** 一次查询最多可查询10,000条记录。

    完成查询后，在审计日志页面下方查看返回记录。

    ![查看搜索结果](https://static-aliyun-doc.oss-cn-hangzhou.aliyuncs.com/assets/img/zh-CN/4464885851/p49374.png)

6.  您可以单击**设置显示列**图标，并在设置显示列对话框中选中要在返回结果中显示的列选项。

    ![设置显示列按钮](https://static-aliyun-doc.oss-cn-hangzhou.aliyuncs.com/assets/img/zh-CN/5464885851/p49360.png)

    ![设置显示列](https://static-aliyun-doc.oss-cn-hangzhou.aliyuncs.com/assets/img/zh-CN/5464885851/p49361.png)


